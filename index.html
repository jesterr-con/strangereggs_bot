import React, { useState, useEffect } from 'react';

const KinderTapper = () => {
  const [points, setPoints] = useState(0); // –ó–∞–≥–∞–ª—å–Ω–∏–π –±–∞–ª–∞–Ω—Å (—à–æ–∫–æ–ª–∞–¥)
  const [eggHealth, setEggHealth] = useState(100); // –°—Ç—ñ–π–∫—ñ—Å—Ç—å —è–π—Ü—è
  const [collection, setCollection] = useState([]); // –ó—ñ–±—Ä–∞–Ω—ñ —ñ–≥—Ä–∞—à–∫–∏
  const [isCracking, setIsCracking] = useState(false);

  const toys = ["ü¶Å", "ü¶ñ", "üöó", "üß∏", "ü§ñ", "ü¶Ñ", "üöÅ"];

  const handleTap = (e) => {
    if (eggHealth > 0) {
      setEggHealth(prev => prev - 10); // –í—ñ–¥–Ω—ñ–º–∞—î–º–æ –∂–∏—Ç—Ç—è —è–π—Ü—è
      setPoints(prev => prev + 1); // –î–∞—î–º–æ —Ç—Ä–æ—Ö–∏ —à–æ–∫–æ–ª–∞–¥—É –∑–∞ –∫–æ–∂–µ–Ω —Ç–∞–ø
      setIsCracking(true);
      setTimeout(() => setIsCracking(false), 100);
    } else {
      // –Ø–π—Ü–µ —Ä–æ–∑–±–∏–ª–æ—Å—è!
      const randomToy = toys[Math.floor(Math.random() * toys.length)];
      setCollection([...collection, randomToy]);
      setPoints(prev => prev + 50); // –ë–æ–Ω—É—Å –∑–∞ –≤—ñ–¥–∫—Ä–∏—Ç—Ç—è
      setEggHealth(100); // –ù–æ–≤–µ —è–π—Ü–µ
    }
  };

  return (
    <div className="flex flex-col items-center min-h-screen bg-blue-50 text-slate-800 p-6 font-sans">
      {/* –®–∞–ø–∫–∞ –∑ –±–∞–ª–∞–Ω—Å–æ–º */}
      <div className="w-full flex justify-between items-center bg-white p-4 rounded-2xl shadow-md mb-8">
        <div className="flex flex-col">
          <span className="text-sm text-gray-500 uppercase font-bold">–®–æ–∫–æ–ª–∞–¥</span>
          <span className="text-2xl font-black text-orange-500">{points} üç´</span>
        </div>
        <div className="text-right">
          <span className="text-sm text-gray-500 uppercase font-bold">–ö–æ–ª–µ–∫—Ü—ñ—è</span>
          <div className="text-xl">{collection.length} / 50</div>
        </div>
      </div>

      {/* –û—Å–Ω–æ–≤–Ω–∞ –æ–±–ª–∞—Å—Ç—å –∑ –ö—ñ–Ω–¥–µ—Ä–æ–º */}
      <div className="relative flex flex-col items-center">
        <div 
          onClick={handleTap}
          className={`relative w-64 h-80 transition-transform cursor-pointer
            ${isCracking ? 'scale-95' : 'scale-100'} 
            ${eggHealth < 50 ? 'animate-pulse' : ''}`}
        >
          {/* –í—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—è —è–π—Ü—è (–º–æ–∂–Ω–∞ –∑–∞–º—ñ–Ω–∏—Ç–∏ –Ω–∞ SVG –∞–±–æ –∫–∞—Ä—Ç–∏–Ω–∫—É) */}
          <div className="w-full h-full bg-gradient-to-b from-white via-white to-orange-500 rounded-[50%_50%_50%_50%_/_60%_60%_40%_40%] shadow-xl border-4 border-white flex items-center justify-center overflow-hidden">
             <span className="text-6xl select-none">ü•ö</span>
             {/* –í—ñ–∑—É–∞–ª—å–Ω—ñ —Ç—Ä—ñ—â–∏–Ω–∏ –ø—Ä–∏ –Ω–∏–∑—å–∫–æ–º—É –∑–¥–æ—Ä–æ–≤'—ó */}
             {eggHealth < 50 && <div className="absolute inset-0 bg-[url('https://www.transparenttextures.com/patterns/cracked-glass.png')] opacity-30"></div>}
          </div>
        </div>

        {/* –®–∫–∞–ª–∞ —Ä–æ–∑–±–∏—Ç—Ç—è */}
        <div className="mt-8 w-64">
          <p className="text-center text-xs font-bold mb-1 uppercase text-gray-400">–ú—ñ—Ü–Ω—ñ—Å—Ç—å —à–∫–∞—Ä–∞–ª—É–ø–∏</p>
          <div className="w-full bg-gray-200 h-4 rounded-full border-2 border-white shadow-inner">
            <div 
              className="bg-orange-400 h-full transition-all duration-200" 
              style={{ width: `${eggHealth}%` }}
            ></div>
          </div>
        </div>
      </div>

      {/* –û—Å—Ç–∞–Ω–Ω—ñ –∑–Ω–∞–π–¥–µ–Ω—ñ —ñ–≥—Ä–∞—à–∫–∏ */}
      <div className="mt-auto w-full max-w-sm">
        <h3 className="font-bold mb-2">–¢–≤–æ—è –ø–æ–ª–∏—Ü—è:</h3>
        <div className="flex gap-2 overflow-x-auto p-2 bg-white rounded-xl shadow-inner min-h-[50px]">
          {collection.map((toy, index) => (
            <span key={index} className="text-3xl bg-gray-100 rounded-lg p-1">{toy}</span>
          ))}
        </div>
      </div>
    </div>
  );
};

export default KinderTapper;
